
<section class="filter-categories">
  <h3 class="filter-categories__title">{{ $t('Filter') }}</h3>
  <div class="filter-categories__links">
    <a
      href="#"
      v-if="isAuthenticated"
      class="filter-categories__save"
      @click.prevent="showPopupSaveFilter()"
    >
      {{ $t('Save-selection') }}
    </a>
    <a
      href="/materials/search/"
      @click.prevent="resetFilter"
      class="filter-categories__reset"
    >{{ $t('Reset-filters') }}</a>
  </div>
  <div class="select filter-categories__select" v-if="isAuthenticated && filters && filters.length">
    <select
      name="my_filters"
      @change="onFilterSelected"
      :value="active_filter_id"
    >
      <option value="" disabled>{{ $t('My-filter-selections') }}</option>
      <option
        :value="filter.id"
        v-for="filter in filters"
      >
        {{ filter.title }}
      </option>
    </select>
  </div>

  <div class="filter-categories__items">
    <ul v-if="categories" class="filter-categories__items_wrapper">
      <li
        v-for="(category, index) in categories.results"
        class="filter-categories__item"
        v-if="!category.hide"
      >
        <h4
          @click="onToggleCategory(category.external_id)"
          class="filter-categories__item_title"
          :class="{'filter-categories__item_title--hide': category.selected}"
         >{{ getTitleTranslation(category, $i18n.locale) }}</h4>
        <div
          v-if="category.external_id === publisherdate && category.selected"
          class="filter-categories__subitems"
        >
          <DatesRange
            v-if="data"
            :inline="true"
            :hide-select="true"
            v-model="data"
            theme="min"
            :disable-future-days="true"
          />
        </div>
        <ul v-else-if="category.selected" class="filter-categories__subitems">
          <li
            v-for="(item, indexItem) in category.items"
            class="filter-categories__subitem"
            v-if="category.show_all || indexItem < visible_items"
            :class="{'filter-categories__subitem--empty': item.is_empty}"
          >
            <input
              type="checkbox"
              :id="item.external_id"
              :value="item.external_id"
              v-model="filter[index].items[indexItem]"
              @change="onChange"
            >
            <label :for="item.external_id">{{item.title}}</label>
          </li>
          <li v-if="category.items.length > visible_items" class="filter-categories__subitem--show-more">
            <a
              href="/show-more/"
              @click.prevent="onToggleShowAll(category.id)"
              v-if="category.show_all"
            >
              {{ $t('Hide') }}
            </a>
            <a
              href="/show-more/"
              @click.prevent="onToggleShowAll(category.id)"
              v-else
            >
              {{ $t('View-more') }} ({{ category.items.length - visible_items }})
            </a>
          </li>
        </ul>
      </li>
    </ul>
  </div>
</section>

